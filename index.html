<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Kassenbuch â€“ PhysioTraining</title>

<style>
:root {
    --primary: #0b6e7f;
    --secondary: #e85a9b;
    --bg: #f5f9fa;
}

body {
    font-family: Arial, sans-serif;
    background: var(--bg);
    margin: 0;
}

header {
    background: white;
    padding: 20px;
    display: flex;
    align-items: center;
    border-bottom: 4px solid var(--primary);
}

header img {
    height: 60px;
}

header h1 {
    margin-left: 20px;
    color: var(--primary);
}

.container {
    padding: 20px;
}

input, select, button {
    padding: 8px;
    margin: 5px;
}

button {
    background: var(--primary);
    color: white;
    border: none;
    cursor: pointer;
}

button:hover {
    background: var(--secondary);
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    background: white;
}

th, td {
    border: 1px solid #ccc;
    padding: 8px;
    text-align: center;
}

th {
    background: var(--primary);
    color: white;
}

.total {
    margin-top: 20px;
    font-size: 20px;
    font-weight: bold;
    color: var(--primary);
}
</style>
</head>

<body>

<header>
    <img src="LOGO_Physio-Training-com_high RGB_v1.jpg">
    <h1>Kassenbuch</h1>
</header>

<div class="container">

<select id="currency">
    <option value="CHF">CHF (Standard)</option>
    <option value="EUR">EUR</option>
</select>

<span id="rateInfo"></span><br>

<input type="number" id="eingang" placeholder="Eingang" step="0.01">
<input type="number" id="ausgang" placeholder="Ausgang" step="0.01">
<input type="text" id="bemerkung" placeholder="Bemerkung">

<button onclick="addEntry()">Speichern</button>

<table>
<thead>
<tr>
<th>Datum</th>
<th>Eingang (CHF)</th>
<th>Ausgang (CHF)</th>
<th>Bemerkung</th>
<th>Saldo (CHF)</th>
<th>Aktion</th>
</tr>
</thead>
<tbody id="table"></tbody>
</table>

<div class="total">
Aktueller Kassenbestand: <span id="total">0.00</span> CHF
</div>

</div>

<script>
let entries = JSON.parse(localStorage.getItem("kasse")) || [];
let eurRate = 1;

// Wechselkurs laden
async function loadRate() {
    const res = await fetch("https://api.exchangerate.host/latest?base=EUR&symbols=CHF");
    const data = await res.json();
    eurRate = data.rates.CHF;
    document.getElementById("rateInfo").innerText =
        `Aktueller Kurs: 1 EUR = ${eurRate.toFixed(4)} CHF`;
}
loadRate();

function save() {
    localStorage.setItem("kasse", JSON.stringify(entries));
}

function render() {
    let saldo = 0;
    let html = "";

    entries.forEach((e, i) => {
        saldo += e.eingang - e.ausgang;
        html += `
        <tr>
            <td>${e.datum}</td>
            <td>${e.eingang.toFixed(2)}</td>
            <td>${e.ausgang.toFixed(2)}</td>
            <td>${e.bemerkung}</td>
            <td>${saldo.toFixed(2)}</td>
            <td><button onclick="remove(${i})">X</button></td>
        </tr>`;
    });

    document.getElementById("table").innerHTML = html;
    document.getElementById("total").innerText = saldo.toFixed(2);
}

function addEntry() {
    let eingang = parseFloat(eingangInput.value) || 0;
    let ausgang = parseFloat(ausgangInput.value) || 0;
    const currency = currencySelect.value;

    // Umrechnung nach CHF
    if (currency === "EUR") {
        eingang *= eurRate;
        ausgang *= eurRate;
    }

    entries.push({
        datum: new Date().toLocaleDateString("de-CH"),
        eingang,
        ausgang,
        bemerkung: bemerkungInput.value
    });

    save();
    render();

    eingangInput.value = "";
    ausgangInput.value = "";
    bemerkungInput.value = "";
}

function remove(index) {
    entries.splice(index, 1);
    save();
    render();
}

const eingangInput = document.getElementById("eingang");
const ausgangInput = document.getElementById("ausgang");
const bemerkungInput = document.getElementById("bemerkung");
const currencySelect = document.getElementById("currency");

render();
</script>

</body>
</html>
